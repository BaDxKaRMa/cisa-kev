<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CISA KEV Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' style='display:block'%3E%3Cpath d='M8 1 L14 3.5 V9.5 C14 12.5 11.5 14.5 8 15 C4.5 14.5 2 12.5 2 9.5 V3.5 Z' fill='%23007bff'/%3E%3Cpath d='M8 1 L14 3.5 V9.5 C14 12.5 11.5 14.5 8 15 Z' fill='%23ff2d2d'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="static/css/styles.css">
</head>
<body>
    <h1>CISA Known Exploited Vulnerabilities</h1>
    <div class="section">
        <strong>Catalog Version:</strong> {{ catalogVersion }}<br>
        <strong>Date Released:</strong> {{ dateReleased }}<br>
        <strong>Total Vulnerabilities:</strong> {{ count }}
    </div>

    <div class="legend">
        <div class="legend-item"><span class="legend-color legend-past"></span> Due date passed</div>
        <div class="legend-item"><span class="legend-color legend-soon"></span> Due date within 14 days</div>
        <div class="legend-item"><span class="legend-color legend-high"></span> Known ransomware use</div>
        <div class="legend-item"><span class="legend-color legend-recent"></span> Added in last 30 days</div>
    </div>


    <div class="section">
        <div class="table-header">Vulnerabilities
            <label class="view-filter" style="margin-left: 1em; font-weight: normal;">
                View:
                <select id="view-selector">
                    <option value="recent">Recently Added</option>
                    <option value="high">High Priority</option>
                    <option value="all">All</option>
                </select>
            </label>
        </div>
        <div id="view-desc" class="desc" style="margin-bottom: 0.5em;">
            <!-- Dynamic view description will be inserted here by JS -->
        </div>
        <div class="table-controls">
            <input class="search-bar" type="text" id="main-search" placeholder="Search...">
            <label class="per-page">Per page:
                <select id="main-per-page">
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="all">All</option>
                </select>
            </label>
            <!-- Ransomware filter removed: High Priority view covers this use case -->
            <div class="export-buttons">
                <button class="export-btn" id="main-export-filtered">Export to CSV</button>
            </div>
        </div>
        <div class="table-wrapper">
        <table id="main-table">
            <thead>
            <tr>
                <th>CVE ID</th><th>Name</th><th>Vendor</th><th>Product</th><th>Date Added</th><th title="Required remediation date set by CISA">Due Date</th><th>Ransomware</th>
            </tr>
            </thead>
            <tbody id="main-table-body">
            <!-- Table rows will be populated by dashboard.js using JSON data -->
            </tbody>
        </table>
        </div>
        <div class="pagination" id="main-pagination"></div>
    </div>

    <script src="static/js/dashboard.js"></script>
</body>
</html>
