<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self' data:; connect-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none'; form-action 'self'">
    <title>CISA KEV Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' style='display:block'%3E%3Cpath d='M8 1 L14 3.5 V9.5 C14 12.5 11.5 14.5 8 15 C4.5 14.5 2 12.5 2 9.5 V3.5 Z' fill='%23007bff'/%3E%3Cpath d='M8 1 L14 3.5 V9.5 C14 12.5 11.5 14.5 8 15 Z' fill='%23ff2d2d'/%3E%3C/svg%3E">
    <link rel="stylesheet" href="./static/css/styles.css">
</head>
<body>
    <header class="page-hero">
        <h1>CISA Known Exploited Vulnerabilities</h1>
        <p class="page-subtitle">Daily-updated tracking and triage view for the CISA KEV catalog.</p>
    </header>
    <div id="main-status" class="status-message" role="status" aria-live="polite" aria-atomic="true"></div>
    <div class="section">
        <strong>Catalog Version:</strong> {{ catalogVersion }}<br>
        <strong>Date Released:</strong> {{ dateReleased }}<br>
        <strong>Last Synced (UTC):</strong> {{ lastSynced }}<br>
        <strong>Total Vulnerabilities:</strong> {{ count }}
    </div>

    <div class="legend">
        <div class="legend-item"><span class="legend-color legend-past"></span> Due date passed</div>
        <div class="legend-item"><span class="legend-color legend-soon"></span> Due date within 14 days</div>
        <div class="legend-item"><span class="legend-color legend-high"></span> Known ransomware use</div>
        <div class="legend-item"><span class="legend-color legend-recent"></span> Added in last 30 days</div>
    </div>


    <div class="section">
        <div class="table-header">Vulnerabilities
            <label class="view-filter">
                View:
                <select id="view-selector">
                    <option value="recent">Recently Added</option>
                    <option value="high">High Priority</option>
                    <option value="all">All</option>
                </select>
            </label>
        </div>
        <div id="view-desc" class="desc compact-desc">
            <!-- Dynamic view description will be inserted here by JS -->
        </div>
        <div class="table-controls">
            <label for="main-search" class="visually-hidden">Search vulnerabilities</label>
            <input class="search-bar" type="text" id="main-search" placeholder="Search...">
            <label class="per-page">Per page:
                <select id="main-per-page">
                    <option value="25">25</option>
                    <option value="50">50</option>
                    <option value="100">100</option>
                    <option value="all">All</option>
                </select>
            </label>
            <details class="column-settings">
                <summary>Columns</summary>
                <div class="column-options">
                    <label><input class="column-toggle" type="checkbox" data-col="0" checked> CVE ID</label>
                    <label><input class="column-toggle" type="checkbox" data-col="1" checked> Name</label>
                    <label><input class="column-toggle" type="checkbox" data-col="2" checked> Vendor</label>
                    <label><input class="column-toggle" type="checkbox" data-col="3" checked> Product</label>
                    <label><input class="column-toggle" type="checkbox" data-col="4" checked> Date Added</label>
                    <label><input class="column-toggle" type="checkbox" data-col="5" checked> Due Date</label>
                    <label><input class="column-toggle" type="checkbox" data-col="6" checked> Ransomware</label>
                    <button id="reset-columns" type="button" class="mini-btn">Reset Default</button>
                </div>
            </details>
            <!-- Ransomware filter removed: High Priority view covers this use case -->
            <div class="export-buttons">
                <button class="export-btn" id="main-export-filtered">Export to CSV</button>
            </div>
        </div>
        <div class="table-wrapper">
        <table id="main-table">
            <caption class="visually-hidden">CISA Known Exploited Vulnerabilities table</caption>
            <thead>
            <tr>
                <th scope="col">CVE ID</th><th scope="col">Name</th><th scope="col">Vendor</th><th scope="col">Product</th><th scope="col">Date Added</th><th scope="col" title="Required remediation date set by CISA">Due Date</th><th scope="col">Ransomware</th>
            </tr>
            </thead>
            <tbody id="main-table-body">
            <!-- Table rows will be populated by dashboard.js using JSON data -->
            </tbody>
        </table>
        </div>
        <div class="pagination" id="main-pagination"></div>
    </div>

    <script src="./static/js/dashboard.js"></script>
</body>
</html>
